var commonWindow=require("ui/iphone/ApplicationWindow"),Data=require("ui/common/DAL"),mapWindow=function(e){function i(){function e(e){var i=Ti.Map.createAnnotation({latitude:e.latitude,longitude:e.longitude,title:e.bar,subtitle:e.location,pincolor:Ti.Map.ANNOTATION_RED,animate:!0,myid:1});return i}var i=new commonWindow;addTitleBar("Find Tromba",i);var t,a;Ti.Geolocation.purpose="GPS user coordinates",Ti.Geolocation.getCurrentPosition(function(e){e.error||(t=e.coords.longitude,a=e.coords.latitude)});for(var n=[],r=0;o.length>r;r++)n[r]=new e(o[r]);var d=Ti.Map.createView({mapType:Ti.Map.STANDARD_TYPE,animate:!0,regionFit:!0,userLocation:!0,annotations:n}),l={latitude:a,longitude:t,latitudeDelta:.01,longitudeDelta:.018};return d.setLocation(l),i.addEventListener("open",function(){var e={latitude:a,longitude:t,latitudeDelta:.01,longitudeDelta:.018};d.setLocation(e)}),i.add(d),i}function t(){var i,t,o=new commonWindow;Ti.Geolocation.purpose="GPS user coordinates",Ti.Geolocation.getCurrentPosition(function(e){e.error||(i=e.coords.longitude,t=e.coords.latitude)});var a=Ti.Map.createAnnotation({latitude:e.latitude,longitude:e.longitude,title:e.bar,subtitle:e.location,pincolor:Ti.Map.ANNOTATION_RED,animate:!0,myid:1}),n=Ti.Map.createView({mapType:Ti.Map.STANDARD_TYPE,animate:!0,regionFit:!0,userLocation:!0,annotations:[a]}),r={latitude:t,longitude:i,latitudeDelta:.01,longitudeDelta:.018};return n.setLocation(r),o.addEventListener("open",function(){var i={latitude:e.latitude,longitude:e.longitude,latitudeDelta:.01,longitudeDelta:.018};n.setLocation(i)}),a.addEventListener("click",function(){}),o.add(n),o}var o=Data.readTrombData("drinks");return mapwin=e?new t:new i};module.exports=mapWindow;